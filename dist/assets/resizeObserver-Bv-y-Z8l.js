import{S as F,W as j,L as G,P as W,a as L,R as _,B as D,V,A as $,J as q,c as X,C as Y}from"./three.module-Ovx678Xv.js";import{S as I}from"./stats.module--VATS4Kh.js";import{G as J}from"./GLTFLoader-DRcDx2hr.js";import{E as K,R as N,O as Q,S as E,F as U,G as Z}from"./GammaCorrectionShader-CXhsNxzJ.js";let c,d,w,T,P,s,b,M,k=0,f=null,r={x:-1e5,y:-1e5},R,p={x:-1e5,y:-1e5},v,S,m,z,a,g,B;const t=document.querySelector("#canvas"),x=document.querySelector("#htmlContent");function ee(){if(!t){console.error("Canvas element not found.");return}S=new X,S.onProgress=function(l,o,u){const i=o/u*100;console.log(`Progress: ${i.toFixed(2)}% (${o} of ${u})`)},c=new F,c.background=null,w=new j({antialias:!0,alpha:!0,premultipliedAlpha:!1,canvas:t}),w.outputColorSpace=G,d=new W(55,t.clientWidth/t.clientHeight,.1,100),d.position.set(0,0,2),m=new K(w),z=new N(c,d),m.addPass(z),a=new Q(new L(t.clientWidth,t.clientHeight),c,d),a.edgeStrength=1,a.edgeGlow=2,a.edgeThickness=5,a.pulsePeriod=0,a.visibleEdgeColor.set("#000000"),a.hiddenEdgeColor.set("#000000"),a.selectedObjects=c.children,m.addPass(a),g=new E(U);const e=Math.min(window.devicePixelRatio,4);g.material.uniforms.resolution.value.x=1/(t.clientWidth*e),g.material.uniforms.resolution.value.y=1/(t.clientHeight*e),m.addPass(g),B=new E(Z),m.addPass(B),v=new _,new L,P=new I,document.body.appendChild(P.dom),new J(S).load("../../models/bunny/12_animations.glb",l=>{s=l.scene,s.position.y-=new D().setFromObject(s).getSize(new V).y*.5,c.add(s);const o=l.animations.find(u=>u.name.toLowerCase()==="idle");o&&te(o)},void 0,l=>{console.error("Error loading bunny:",l)});const O=new $(16777215,2);c.add(O),T=new Y,w.setAnimationLoop(ne),window.addEventListener("scroll",oe),window.addEventListener("mousemove",H),window.addEventListener("mouseout",C),window.addEventListener("mouseleave",C),window.addEventListener("click",A),window.addEventListener("touchstart",ie),window.addEventListener("touchend",ae),new ResizeObserver(l=>{for(const o of l){const u=Math.min(window.devicePixelRatio,4);let i,h;o.devicePixelContentBoxSize?(i=o.devicePixelContentBoxSize[0].inlineSize,h=o.devicePixelContentBoxSize[0].blockSize):(i=Math.round(o.contentBoxSize[0].inlineSize*u),h=Math.round(o.contentBoxSize[0].blockSize*u)),d.aspect=i/h,d.updateProjectionMatrix(),w.setSize(i,h,!1),o.target.width=i,o.target.height=h,m.setSize(i,h),g.material.uniforms.resolution.value.set(1/i,1/h)}}).observe(t)}function ne(){const e=T.getDelta();P.update(),b&&b.update(e),s&&(s.rotation.y=k*Math.PI*-2),re(),m.render(c,d)}function te(e){b=new q(s),M=b.clipAction(e),M.play()}function oe(){const e=window.pageYOffset,n=document.documentElement.scrollHeight-window.innerHeight;k=e/n}function ie(e){H(e.touches[0]),R=Date.now(),p.x=r.x,p.y=r.y}function ae(){Date.now()-R<200&&Math.abs(p.x-r.x)<.01&&Math.abs(p.y-r.y)<.01&&A(),C()}function A(){if(f)switch(f.name){case"bunny002_1":y("Bunny Body");break;case"bunny002_2":y("Bunny Head");break;case"bunny002_3":y("Bunny Eye");break;default:y("HTML Content");break}else y("HTML Content")}function y(e){if(x)for(let n=x.children.length-1;n>=0;n--)x.children[n].innerHTML=e}function se(e){const n=t.getBoundingClientRect();return{x:(e.clientX-n.left)*t.width/n.width,y:(e.clientY-n.top)*t.height/n.height}}function H(e){const n=se(e);r.x=n.x/t.width*2-1,r.y=n.y/t.height*-2+1}function C(){r.x=-1e5,r.y=-1e5}function re(){if(v.setFromCamera(r,d),s){const e=v.intersectObjects(s.children[0].children[0].children,!0);e.length>0?f!==e[0].object&&(f=e[0].object,document.body.style.cursor="pointer"):f!==null&&(f=null,document.body.style.cursor="default")}}ee();
