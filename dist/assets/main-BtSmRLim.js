import{V as _,S as Y,W as Z,L as J,P as Q,a as z,R as ee,B as te,A as ne,b as ie,c as oe,C as ae}from"./three.module-Ovx678Xv.js";import{S as re}from"./stats.module--VATS4Kh.js";import{G as se}from"./GLTFLoader-DRcDx2hr.js";import{E as le}from"./EXRLoader-BrqGqE0a.js";import{E as ce,R as de,O as ue,S as B,F as me,G as he}from"./GammaCorrectionShader-CXhsNxzJ.js";import{O as fe}from"./OrbitControls-BeonOkOq.js";let h,o,s={x:0,y:.22,z:1.2},f,V,A,u,W,i=null,a={x:-1e5,y:-1e5},X,P={x:-1e5,y:-1e5},O,b,j,R,m,g,U,r,x,F,y,T,S,L,E=.1,H=.03,k=new _,v=new _;const c=window.location.pathname.split("/"),n=document.querySelector("#canvas"),M=["home","01_setup","02_line","03_responsive","04_orbit","05_nesting","06_lil-gui","07_load_gltf","08_load_bunny","09_materials","10_textures","11_textures_gltf","12_animations","13_lighting","14_background","15_userinteraction"];c[0]=="di-men3-three.js"&&c[1]!="dist"&&(window.location.href="dist/");function ge(){if(!n){console.error("Canvas element not found.");return}b=new oe,b.onProgress=function(d,p,w){const C=p/w*100;console.log(`Progress: ${C.toFixed(2)}% (${p} of ${w})`)},b.onLoad=function(){h.environment=W,h.add(u)},h=new Y,h.background=null,f=new Z({antialias:!0,alpha:!0,premultipliedAlpha:!1,canvas:n}),f.outputColorSpace=J,o=new Q(55,n.clientWidth/n.clientHeight,.1,100),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y,0),g=new ce(f),U=new de(h,o),g.addPass(U),r=new ue(new z(n.clientWidth,n.clientHeight),h,o),r.edgeStrength=3,r.edgeGlow=0,r.edgeThickness=3,r.pulsePeriod=0,r.visibleEdgeColor.set("#ffffff"),r.hiddenEdgeColor.set("#ffffff"),g.addPass(r),x=new B(me);const e=Math.min(window.devicePixelRatio,4);x.material.uniforms.resolution.value.x=1/(n.clientWidth*e),x.material.uniforms.resolution.value.y=1/(n.clientHeight*e),g.addPass(x),F=new B(he),g.addPass(F),m=new fe(o,f.domElement),m.listenToKeyEvents(window),m.enableDamping=!0,m.enablePan=!1,m.enableZoom=!0,m.enableRotate=!1,m.target.set(s.x,s.y,0),m.update(),O=new ee,new z,A=new re,document.body.appendChild(A.dom),new se(b).load("./models/control_panel/v06_control_panel.glb",d=>{u=d.scene;const p=new te().setFromObject(u).getSize(new _);if(u.position.y-=p.y*.5,u.position.x-=p.x*.5,console.log(p),y=u.children[1].children[2].children[1].material.clone(),T=y.clone(),y.name="light_green_lit",T.emissive.set("#1CBB22"),S=u.children[1].children[3].children[1].material.clone(),L=S.clone(),S.name="light_red_lit",L.emissive.set("#CC1C1C"),c[c.length-1]=="index.html"){const w=Number((c[c.length-2].match(/\d+/)||[0])[0]);w>0&&w<16&&(u.children.find(C=>C.name=="button_"+(w+1).toString().padStart(2,"0")).children[3].children[1].material=L)}else u.children[2].children[3].children[1].material=L},void 0,d=>{console.error("Error loading model:",d)});const l=new ne(16777215,2);h.add(l),j=new le(b),R=new ie(f),j.load("./hdri/hdri_peppermint_powerplant_2k.exr",d=>{W=R.fromEquirectangular(d).texture,d.dispose(),R.dispose()}),V=new ae,f.setAnimationLoop(pe),window.addEventListener("resize",D,!1),D(),window.addEventListener("mousemove",K),window.addEventListener("mouseout",G),window.addEventListener("mouseleave",G),window.addEventListener("click",q),window.addEventListener("touchstart",xe),window.addEventListener("touchend",be)}function pe(){V.getDelta(),A.update(),ye(),Pe(),g.render(h,o)}function D(){const e=Math.min(window.devicePixelRatio,4),t=Math.round(n.clientWidth*e),l=Math.round(n.clientHeight*e);f.setSize(t,l,!1),n.width=t,n.height=l,m.update(),_e(),g.setSize(t,l),x.material.uniforms.resolution.value.x=1/(t*e),x.material.uniforms.resolution.value.y=1/(l*e),o.aspect=n.clientWidth/n.clientHeight,o.updateProjectionMatrix()}function we(e){const t=e.match(/button_(\d+)/);return t&&t[1]?parseInt(t[1],10):null}function $(e){const t=we(e);return t==null?null:c[c.length-1]=="index.html"?c[c.length-2]==M[t-1]?null:"../"+M[t-1]+"/index.html":t==1?null:"dist/src/"+M[t-1]+"/index.html"}function q(){if(i&&i.name.includes("button")){console.log("Clicked:",i.parent.name);const e=$(i.parent.name);e&&setTimeout(()=>{window.location.href=e},500)}}function xe(e){K(e.touches[0]),X=Date.now(),P.x=a.x,P.y=a.y}function be(){Date.now()-X<200&&Math.abs(P.x-a.x)<.01&&Math.abs(P.y-a.y)<.01&&q(),G()}function Le(e){const t=n.getBoundingClientRect();return{x:(e.clientX-t.left)*n.width/t.width,y:(e.clientY-t.top)*n.height/t.height}}function K(e){const t=Le(e);a.x=t.x/n.width*2-1,a.y=t.y/n.height*-2+1}function G(){a.x=-1e5,a.y=-1e5}function ve(){i.name.includes("_")?r.selectedObjects=[i]:r.selectedObjects=[i.parent.children[1]],document.body.style.cursor="pointer",$(i.parent.name)&&(i.parent.children[2].children[1].material=T)}function N(){r.selectedObjects=[],document.body.style.cursor="default"}function I(e){e==null||!e.name.includes("button")||(e.parent.children[2].children[1].material=y)}function ye(){O.setFromCamera(a,o);const e=O.intersectObjects(h.children,!0);e.length>0?i!==e[0].object&&(I(i),i=e[0].object,i.name.includes("button")?ve():N()):i!==null&&(N(),I(i),i=null)}function Pe(){a.x==-1e5||a.y==-1e5?(k.set(s.x,s.y,0),E=.02):(k.set(s.x+H*a.x,s.y+H*a.y,0),E=.1),o.getWorldDirection(v),v.add(o.position),v.lerp(k,E),o.lookAt(v)}function _e(){const e=new _(1.4,.7,.5),t=n.clientWidth/n.clientHeight,l=o.fov*(Math.PI/180),d=Math.max(e.x/(2*Math.tan(l/2)*t),e.y/(2*Math.tan(l/2)),e.z);o.position.z=.25+d*1.1}ge();
