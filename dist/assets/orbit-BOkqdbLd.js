import"./modulepreload-polyfill-B5Qt9EMX.js";import{R as Zt,d as kt,V as l,C as Dt,e as q,T as W,Q as v,f as _t,g as R,h as zt,i as Xt,j as vt,O as pt,M as dt,L as Qt,k as E,B as w,b as ft,F as yt,a,l as it,c as C,m as Nt,n as F,o as Ut,D as Wt,E as qt,S as Ft,W as Gt,A as Kt,G as Bt,P as Vt}from"./three.module-CmLSQrpk.js";import{g as $t}from"./lil-gui.module.min-Bc0DeA9g.js";const wt={type:"change"},ut={type:"start"},At={type:"end"},st=new Zt,bt=new kt,Jt=Math.cos(70*zt.DEG2RAD),_=new l,M=2*Math.PI,c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},ht=1e-6;class te extends Dt{constructor(t,e=null){super(t,e),this.state=c.NONE,this.enabled=!0,this.target=new l,this.cursor=new l,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:q.ROTATE,MIDDLE:q.DOLLY,RIGHT:q.PAN},this.touches={ONE:W.ROTATE,TWO:W.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new l,this._lastQuaternion=new v,this._lastTargetPosition=new l,this._quat=new v().setFromUnitVectors(t.up,new l(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new _t,this._sphericalDelta=new _t,this._scale=1,this._panOffset=new l,this._rotateStart=new R,this._rotateEnd=new R,this._rotateDelta=new R,this._panStart=new R,this._panEnd=new R,this._panDelta=new R,this._dollyStart=new R,this._dollyEnd=new R,this._dollyDelta=new R,this._dollyDirection=new l,this._mouse=new R,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=ie.bind(this),this._onPointerDown=ee.bind(this),this._onPointerUp=se.bind(this),this._onContextMenu=ce.bind(this),this._onMouseWheel=ae.bind(this),this._onKeyDown=re.bind(this),this._onTouchStart=he.bind(this),this._onTouchMove=le.bind(this),this._onMouseDown=oe.bind(this),this._onMouseMove=ne.bind(this),this._interceptControlDown=pe.bind(this),this._interceptControlUp=de.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(wt),this.update(),this.state=c.NONE}update(t=null){const e=this.object.position;_.copy(e).sub(this.target),_.applyQuaternion(this._quat),this._spherical.setFromVector3(_),this.autoRotate&&this.state===c.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let s=this.minAzimuthAngle,o=this.maxAzimuthAngle;isFinite(s)&&isFinite(o)&&(s<-Math.PI?s+=M:s>Math.PI&&(s-=M),o<-Math.PI?o+=M:o>Math.PI&&(o-=M),s<=o?this._spherical.theta=Math.max(s,Math.min(o,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(s+o)/2?Math.max(s,this._spherical.theta):Math.min(o,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let h=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const i=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),h=i!=this._spherical.radius}if(_.setFromSpherical(this._spherical),_.applyQuaternion(this._quatInverse),e.copy(this.target).add(_),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let i=null;if(this.object.isPerspectiveCamera){const r=_.length();i=this._clampDistance(r*this._scale);const m=r-i;this.object.position.addScaledVector(this._dollyDirection,m),this.object.updateMatrixWorld(),h=!!m}else if(this.object.isOrthographicCamera){const r=new l(this._mouse.x,this._mouse.y,0);r.unproject(this.object);const m=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),h=m!==this.object.zoom;const S=new l(this._mouse.x,this._mouse.y,0);S.unproject(this.object),this.object.position.sub(S).add(r),this.object.updateMatrixWorld(),i=_.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;i!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(i).add(this.object.position):(st.origin.copy(this.object.position),st.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(st.direction))<Jt?this.object.lookAt(this.target):(bt.setFromNormalAndCoplanarPoint(this.object.up,this.target),st.intersectPlane(bt,this.target))))}else if(this.object.isOrthographicCamera){const i=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),i!==this.object.zoom&&(this.object.updateProjectionMatrix(),h=!0)}return this._scale=1,this._performCursorZoom=!1,h||this._lastPosition.distanceToSquared(this.object.position)>ht||8*(1-this._lastQuaternion.dot(this.object.quaternion))>ht||this._lastTargetPosition.distanceToSquared(this.target)>ht?(this.dispatchEvent(wt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?M/60*this.autoRotateSpeed*t:M/60/60*this.autoRotateSpeed}_getZoomScale(t){const e=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*e)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,e){_.setFromMatrixColumn(e,0),_.multiplyScalar(-t),this._panOffset.add(_)}_panUp(t,e){this.screenSpacePanning===!0?_.setFromMatrixColumn(e,1):(_.setFromMatrixColumn(e,0),_.crossVectors(this.object.up,_)),_.multiplyScalar(t),this._panOffset.add(_)}_pan(t,e){const s=this.domElement;if(this.object.isPerspectiveCamera){const o=this.object.position;_.copy(o).sub(this.target);let h=_.length();h*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*h/s.clientHeight,this.object.matrix),this._panUp(2*e*h/s.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/s.clientWidth,this.object.matrix),this._panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/s.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,e){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const s=this.domElement.getBoundingClientRect(),o=t-s.left,h=e-s.top,i=s.width,r=s.height;this._mouse.x=o/i*2-1,this._mouse.y=-(h/r)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(M*this._rotateDelta.x/e.clientHeight),this._rotateUp(M*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let e=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateUp(M*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),e=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateUp(-M*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),e=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateLeft(M*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),e=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateLeft(-M*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),e=!0;break}e&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),s=.5*(t.pageX+e.x),o=.5*(t.pageY+e.y);this._rotateStart.set(s,o)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),s=.5*(t.pageX+e.x),o=.5*(t.pageY+e.y);this._panStart.set(s,o)}}_handleTouchStartDolly(t){const e=this._getSecondPointerPosition(t),s=t.pageX-e.x,o=t.pageY-e.y,h=Math.sqrt(s*s+o*o);this._dollyStart.set(0,h)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),o=.5*(t.pageX+s.x),h=.5*(t.pageY+s.y);this._rotateEnd.set(o,h)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(M*this._rotateDelta.x/e.clientHeight),this._rotateUp(M*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),s=.5*(t.pageX+e.x),o=.5*(t.pageY+e.y);this._panEnd.set(s,o)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const e=this._getSecondPointerPosition(t),s=t.pageX-e.x,o=t.pageY-e.y,h=Math.sqrt(s*s+o*o);this._dollyEnd.set(0,h),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const i=(t.pageX+e.x)*.5,r=(t.pageY+e.y)*.5;this._updateZoomParameters(i,r)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId){this._pointers.splice(e,1);return}}_isTrackingPointer(t){for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId)return!0;return!1}_trackPointer(t){let e=this._pointerPositions[t.pointerId];e===void 0&&(e=new R,this._pointerPositions[t.pointerId]=e),e.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const e=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[e]}_customWheelEvent(t){const e=t.deltaMode,s={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(e){case 1:s.deltaY*=16;break;case 2:s.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(s.deltaY*=10),s}}function ee(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function ie(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function se(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(At),this.state=c.NONE;break;case 1:const t=this._pointers[0],e=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:e.x,pageY:e.y});break}}function oe(n){let t;switch(n.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case q.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=c.DOLLY;break;case q.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=c.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=c.ROTATE}break;case q.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=c.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=c.PAN}break;default:this.state=c.NONE}this.state!==c.NONE&&this.dispatchEvent(ut)}function ne(n){switch(this.state){case c.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case c.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case c.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function ae(n){this.enabled===!1||this.enableZoom===!1||this.state!==c.NONE||(n.preventDefault(),this.dispatchEvent(ut),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(At))}function re(n){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(n)}function he(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case W.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=c.TOUCH_ROTATE;break;case W.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=c.TOUCH_PAN;break;default:this.state=c.NONE}break;case 2:switch(this.touches.TWO){case W.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=c.TOUCH_DOLLY_PAN;break;case W.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=c.TOUCH_DOLLY_ROTATE;break;default:this.state=c.NONE}break;default:this.state=c.NONE}this.state!==c.NONE&&this.dispatchEvent(ut)}function le(n){switch(this._trackPointer(n),this.state){case c.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case c.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case c.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case c.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=c.NONE}}function ce(n){this.enabled!==!1&&n.preventDefault()}function pe(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function de(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const z=new Xt,b=new l,H=new l,u=new v,gt={X:new l(1,0,0),Y:new l(0,1,0),Z:new l(0,0,1)},lt={type:"change"},Pt={type:"mouseDown",mode:null},Et={type:"mouseUp",mode:null},Mt={type:"objectChange"};class ue extends Dt{constructor(t,e=null){super(void 0,e);const s=new be(this);this._root=s;const o=new ge;this._gizmo=o,s.add(o);const h=new Pe;this._plane=h,s.add(h);const i=this;function r(f,L){let N=L;Object.defineProperty(i,f,{get:function(){return N!==void 0?N:L},set:function(k){N!==k&&(N=k,h[f]=k,o[f]=k,i.dispatchEvent({type:f+"-changed",value:k}),i.dispatchEvent(lt))}}),i[f]=L,h[f]=L,o[f]=L}r("camera",t),r("object",void 0),r("enabled",!0),r("axis",null),r("mode","translate"),r("translationSnap",null),r("rotationSnap",null),r("scaleSnap",null),r("space","world"),r("size",1),r("dragging",!1),r("showX",!0),r("showY",!0),r("showZ",!0);const m=new l,S=new l,g=new v,T=new v,y=new l,Z=new v,Q=new l,A=new l,I=new l,x=0,d=new l;r("worldPosition",m),r("worldPositionStart",S),r("worldQuaternion",g),r("worldQuaternionStart",T),r("cameraPosition",y),r("cameraQuaternion",Z),r("pointStart",Q),r("pointEnd",A),r("rotationAxis",I),r("rotationAngle",x),r("eye",d),this._offset=new l,this._startNorm=new l,this._endNorm=new l,this._cameraScale=new l,this._parentPosition=new l,this._parentQuaternion=new v,this._parentQuaternionInv=new v,this._parentScale=new l,this._worldScaleStart=new l,this._worldQuaternionInv=new v,this._worldScale=new l,this._positionStart=new l,this._quaternionStart=new v,this._scaleStart=new l,this._getPointer=me.bind(this),this._onPointerDown=fe.bind(this),this._onPointerHover=_e.bind(this),this._onPointerMove=ye.bind(this),this._onPointerUp=we.bind(this),e!==null&&this.connect()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(t){if(this.object===void 0||this.dragging===!0)return;t!==null&&z.setFromCamera(t,this.camera);const e=ct(this._gizmo.picker[this.mode],z);e?this.axis=e.object.name:this.axis=null}pointerDown(t){if(!(this.object===void 0||this.dragging===!0||t!=null&&t.button!==0)&&this.axis!==null){t!==null&&z.setFromCamera(t,this.camera);const e=ct(this._plane,z,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,Pt.mode=this.mode,this.dispatchEvent(Pt)}}pointerMove(t){const e=this.axis,s=this.mode,o=this.object;let h=this.space;if(s==="scale"?h="local":(e==="E"||e==="XYZE"||e==="XYZ")&&(h="world"),o===void 0||e===null||this.dragging===!1||t!==null&&t.button!==-1)return;t!==null&&z.setFromCamera(t,this.camera);const i=ct(this._plane,z,!0);if(i){if(this.pointEnd.copy(i.point).sub(this.worldPositionStart),s==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),h==="local"&&e!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),e.indexOf("X")===-1&&(this._offset.x=0),e.indexOf("Y")===-1&&(this._offset.y=0),e.indexOf("Z")===-1&&(this._offset.z=0),h==="local"&&e!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),o.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(h==="local"&&(o.position.applyQuaternion(u.copy(this._quaternionStart).invert()),e.search("X")!==-1&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(this._quaternionStart)),h==="world"&&(o.parent&&o.position.add(b.setFromMatrixPosition(o.parent.matrixWorld)),e.search("X")!==-1&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(b.setFromMatrixPosition(o.parent.matrixWorld))));else if(s==="scale"){if(e.search("XYZ")!==-1){let r=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(r*=-1),H.set(r,r,r)}else b.copy(this.pointStart),H.copy(this.pointEnd),b.applyQuaternion(this._worldQuaternionInv),H.applyQuaternion(this._worldQuaternionInv),H.divide(b),e.search("X")===-1&&(H.x=1),e.search("Y")===-1&&(H.y=1),e.search("Z")===-1&&(H.z=1);o.scale.copy(this._scaleStart).multiply(H),this.scaleSnap&&(e.search("X")!==-1&&(o.scale.x=Math.round(o.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Y")!==-1&&(o.scale.y=Math.round(o.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Z")!==-1&&(o.scale.z=Math.round(o.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(s==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const r=20/this.worldPosition.distanceTo(b.setFromMatrixPosition(this.camera.matrixWorld));let m=!1;e==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(b.copy(this.rotationAxis).cross(this.eye))*r):(e==="X"||e==="Y"||e==="Z")&&(this.rotationAxis.copy(gt[e]),b.copy(gt[e]),h==="local"&&b.applyQuaternion(this.worldQuaternion),b.cross(this.eye),b.length()===0?m=!0:this.rotationAngle=this._offset.dot(b.normalize())*r),(e==="E"||m)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),h==="local"&&e!=="E"&&e!=="XYZE"?(o.quaternion.copy(this._quaternionStart),o.quaternion.multiply(u.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),o.quaternion.copy(u.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),o.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(lt),this.dispatchEvent(Mt)}}pointerUp(t){t!==null&&t.button!==0||(this.dragging&&this.axis!==null&&(Et.mode=this.mode,this.dispatchEvent(Et)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}attach(t){return this.object=t,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(lt),this.dispatchEvent(Mt),this.pointStart.copy(this.pointEnd))}getRaycaster(){return z}getMode(){return this.mode}setMode(t){this.mode=t}setTranslationSnap(t){this.translationSnap=t}setRotationSnap(t){this.rotationSnap=t}setScaleSnap(t){this.scaleSnap=t}setSize(t){this.size=t}setSpace(t){this.space=t}}function me(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const t=this.domElement.getBoundingClientRect();return{x:(n.clientX-t.left)/t.width*2-1,y:-(n.clientY-t.top)/t.height*2+1,button:n.button}}}function _e(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n));break}}function fe(n){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function ye(n){this.enabled&&this.pointerMove(this._getPointer(n))}function we(n){this.enabled&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function ct(n,t,e){const s=t.intersectObject(n,!0);for(let o=0;o<s.length;o++)if(s[o].object.visible||e)return s[o];return!1}const ot=new qt,p=new l(0,1,0),St=new l(0,0,0),xt=new vt,nt=new v,rt=new v,j=new l,Tt=new vt,B=new l(1,0,0),X=new l(0,1,0),V=new l(0,0,1),at=new l,G=new l,K=new l;class be extends pt{constructor(t){super(),this.isTransformControlsRoot=!0,this.controls=t,this.visible=!1}updateMatrixWorld(t){const e=this.controls;e.object!==void 0&&(e.object.updateMatrixWorld(),e.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):e.object.parent.matrixWorld.decompose(e._parentPosition,e._parentQuaternion,e._parentScale),e.object.matrixWorld.decompose(e.worldPosition,e.worldQuaternion,e._worldScale),e._parentQuaternionInv.copy(e._parentQuaternion).invert(),e._worldQuaternionInv.copy(e.worldQuaternion).invert()),e.camera.updateMatrixWorld(),e.camera.matrixWorld.decompose(e.cameraPosition,e.cameraQuaternion,e._cameraScale),e.camera.isOrthographicCamera?e.camera.getWorldDirection(e.eye).negate():e.eye.copy(e.cameraPosition).sub(e.worldPosition).normalize(),super.updateMatrixWorld(t)}}class ge extends pt{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const t=new dt({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=new Qt({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),s=t.clone();s.opacity=.15;const o=e.clone();o.opacity=.5;const h=t.clone();h.color.setHex(16711680);const i=t.clone();i.color.setHex(65280);const r=t.clone();r.color.setHex(255);const m=t.clone();m.color.setHex(16711680),m.opacity=.5;const S=t.clone();S.color.setHex(65280),S.opacity=.5;const g=t.clone();g.color.setHex(255),g.opacity=.5;const T=t.clone();T.opacity=.25;const y=t.clone();y.color.setHex(16776960),y.opacity=.25,t.clone().color.setHex(16776960);const Q=t.clone();Q.color.setHex(7895160);const A=new E(0,.04,.1,12);A.translate(0,.05,0);const I=new w(.08,.08,.08);I.translate(0,.04,0);const x=new ft;x.setAttribute("position",new yt([0,0,0,1,0,0],3));const d=new E(.0075,.0075,.5,3);d.translate(0,.25,0);function f(D,$){const O=new F(D,.0075,3,64,$*Math.PI*2);return O.rotateY(Math.PI/2),O.rotateX(Math.PI/2),O}function L(){const D=new ft;return D.setAttribute("position",new yt([0,0,0,1,1,1],3)),D}const N={X:[[new a(A,h),[.5,0,0],[0,0,-Math.PI/2]],[new a(A,h),[-.5,0,0],[0,0,Math.PI/2]],[new a(d,h),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new a(A,i),[0,.5,0]],[new a(A,i),[0,-.5,0],[Math.PI,0,0]],[new a(d,i)]],Z:[[new a(A,r),[0,0,.5],[Math.PI/2,0,0]],[new a(A,r),[0,0,-.5],[-Math.PI/2,0,0]],[new a(d,r),null,[Math.PI/2,0,0]]],XYZ:[[new a(new it(.1,0),T.clone()),[0,0,0]]],XY:[[new a(new w(.15,.15,.01),g.clone()),[.15,.15,0]]],YZ:[[new a(new w(.15,.15,.01),m.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a(new w(.15,.15,.01),S.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},k={X:[[new a(new E(.2,0,.6,4),s),[.3,0,0],[0,0,-Math.PI/2]],[new a(new E(.2,0,.6,4),s),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new a(new E(.2,0,.6,4),s),[0,.3,0]],[new a(new E(.2,0,.6,4),s),[0,-.3,0],[0,0,Math.PI]]],Z:[[new a(new E(.2,0,.6,4),s),[0,0,.3],[Math.PI/2,0,0]],[new a(new E(.2,0,.6,4),s),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new a(new it(.2,0),s)]],XY:[[new a(new w(.2,.2,.01),s),[.15,.15,0]]],YZ:[[new a(new w(.2,.2,.01),s),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a(new w(.2,.2,.01),s),[.15,0,.15],[-Math.PI/2,0,0]]]},It={START:[[new a(new it(.01,2),o),null,null,null,"helper"]],END:[[new a(new it(.01,2),o),null,null,null,"helper"]],DELTA:[[new C(L(),o),null,null,null,"helper"]],X:[[new C(x,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new C(x,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new C(x,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Ot={XYZE:[[new a(f(.5,1),Q),null,[0,Math.PI/2,0]]],X:[[new a(f(.5,.5),h)]],Y:[[new a(f(.5,.5),i),null,[0,0,-Math.PI/2]]],Z:[[new a(f(.5,.5),r),null,[0,Math.PI/2,0]]],E:[[new a(f(.75,1),y),null,[0,Math.PI/2,0]]]},Rt={AXIS:[[new C(x,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},Lt={XYZE:[[new a(new Nt(.25,10,8),s)]],X:[[new a(new F(.5,.1,4,24),s),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new a(new F(.5,.1,4,24),s),[0,0,0],[Math.PI/2,0,0]]],Z:[[new a(new F(.5,.1,4,24),s),[0,0,0],[0,0,-Math.PI/2]]],E:[[new a(new F(.75,.1,2,24),s)]]},jt={X:[[new a(I,h),[.5,0,0],[0,0,-Math.PI/2]],[new a(d,h),[0,0,0],[0,0,-Math.PI/2]],[new a(I,h),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new a(I,i),[0,.5,0]],[new a(d,i)],[new a(I,i),[0,-.5,0],[0,0,Math.PI]]],Z:[[new a(I,r),[0,0,.5],[Math.PI/2,0,0]],[new a(d,r),[0,0,0],[Math.PI/2,0,0]],[new a(I,r),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new a(new w(.15,.15,.01),g),[.15,.15,0]]],YZ:[[new a(new w(.15,.15,.01),m),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a(new w(.15,.15,.01),S),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new a(new w(.1,.1,.1),T.clone())]]},Yt={X:[[new a(new E(.2,0,.6,4),s),[.3,0,0],[0,0,-Math.PI/2]],[new a(new E(.2,0,.6,4),s),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new a(new E(.2,0,.6,4),s),[0,.3,0]],[new a(new E(.2,0,.6,4),s),[0,-.3,0],[0,0,Math.PI]]],Z:[[new a(new E(.2,0,.6,4),s),[0,0,.3],[Math.PI/2,0,0]],[new a(new E(.2,0,.6,4),s),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new a(new w(.2,.2,.01),s),[.15,.15,0]]],YZ:[[new a(new w(.2,.2,.01),s),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a(new w(.2,.2,.01),s),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new a(new w(.2,.2,.2),s),[0,0,0]]]},Ct={X:[[new C(x,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new C(x,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new C(x,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function Y(D){const $=new pt;for(const O in D)for(let U=D[O].length;U--;){const P=D[O][U][0].clone(),J=D[O][U][1],tt=D[O][U][2],et=D[O][U][3],Ht=D[O][U][4];P.name=O,P.tag=Ht,J&&P.position.set(J[0],J[1],J[2]),tt&&P.rotation.set(tt[0],tt[1],tt[2]),et&&P.scale.set(et[0],et[1],et[2]),P.updateMatrix();const mt=P.geometry.clone();mt.applyMatrix4(P.matrix),P.geometry=mt,P.renderOrder=1/0,P.position.set(0,0,0),P.rotation.set(0,0,0),P.scale.set(1,1,1),$.add(P)}return $}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=Y(N)),this.add(this.gizmo.rotate=Y(Ot)),this.add(this.gizmo.scale=Y(jt)),this.add(this.picker.translate=Y(k)),this.add(this.picker.rotate=Y(Lt)),this.add(this.picker.scale=Y(Yt)),this.add(this.helper.translate=Y(It)),this.add(this.helper.rotate=Y(Rt)),this.add(this.helper.scale=Y(Ct)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(t){const s=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:rt;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let o=[];o=o.concat(this.picker[this.mode].children),o=o.concat(this.gizmo[this.mode].children),o=o.concat(this.helper[this.mode].children);for(let h=0;h<o.length;h++){const i=o[h];i.visible=!0,i.rotation.set(0,0,0),i.position.copy(this.worldPosition);let r;if(this.camera.isOrthographicCamera?r=(this.camera.top-this.camera.bottom)/this.camera.zoom:r=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),i.scale.set(1,1,1).multiplyScalar(r*this.size/4),i.tag==="helper"){i.visible=!1,i.name==="AXIS"?(i.visible=!!this.axis,this.axis==="X"&&(u.setFromEuler(ot.set(0,0,0)),i.quaternion.copy(s).multiply(u),Math.abs(p.copy(B).applyQuaternion(s).dot(this.eye))>.9&&(i.visible=!1)),this.axis==="Y"&&(u.setFromEuler(ot.set(0,0,Math.PI/2)),i.quaternion.copy(s).multiply(u),Math.abs(p.copy(X).applyQuaternion(s).dot(this.eye))>.9&&(i.visible=!1)),this.axis==="Z"&&(u.setFromEuler(ot.set(0,Math.PI/2,0)),i.quaternion.copy(s).multiply(u),Math.abs(p.copy(V).applyQuaternion(s).dot(this.eye))>.9&&(i.visible=!1)),this.axis==="XYZE"&&(u.setFromEuler(ot.set(0,Math.PI/2,0)),p.copy(this.rotationAxis),i.quaternion.setFromRotationMatrix(xt.lookAt(St,p,X)),i.quaternion.multiply(u),i.visible=this.dragging),this.axis==="E"&&(i.visible=!1)):i.name==="START"?(i.position.copy(this.worldPositionStart),i.visible=this.dragging):i.name==="END"?(i.position.copy(this.worldPosition),i.visible=this.dragging):i.name==="DELTA"?(i.position.copy(this.worldPositionStart),i.quaternion.copy(this.worldQuaternionStart),b.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),b.applyQuaternion(this.worldQuaternionStart.clone().invert()),i.scale.copy(b),i.visible=this.dragging):(i.quaternion.copy(s),this.dragging?i.position.copy(this.worldPositionStart):i.position.copy(this.worldPosition),this.axis&&(i.visible=this.axis.search(i.name)!==-1));continue}i.quaternion.copy(s),this.mode==="translate"||this.mode==="scale"?(i.name==="X"&&Math.abs(p.copy(B).applyQuaternion(s).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="Y"&&Math.abs(p.copy(X).applyQuaternion(s).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="Z"&&Math.abs(p.copy(V).applyQuaternion(s).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="XY"&&Math.abs(p.copy(V).applyQuaternion(s).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="YZ"&&Math.abs(p.copy(B).applyQuaternion(s).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="XZ"&&Math.abs(p.copy(X).applyQuaternion(s).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1)):this.mode==="rotate"&&(nt.copy(s),p.copy(this.eye).applyQuaternion(u.copy(s).invert()),i.name.search("E")!==-1&&i.quaternion.setFromRotationMatrix(xt.lookAt(this.eye,St,X)),i.name==="X"&&(u.setFromAxisAngle(B,Math.atan2(-p.y,p.z)),u.multiplyQuaternions(nt,u),i.quaternion.copy(u)),i.name==="Y"&&(u.setFromAxisAngle(X,Math.atan2(p.x,p.z)),u.multiplyQuaternions(nt,u),i.quaternion.copy(u)),i.name==="Z"&&(u.setFromAxisAngle(V,Math.atan2(p.y,p.x)),u.multiplyQuaternions(nt,u),i.quaternion.copy(u))),i.visible=i.visible&&(i.name.indexOf("X")===-1||this.showX),i.visible=i.visible&&(i.name.indexOf("Y")===-1||this.showY),i.visible=i.visible&&(i.name.indexOf("Z")===-1||this.showZ),i.visible=i.visible&&(i.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),i.material._color=i.material._color||i.material.color.clone(),i.material._opacity=i.material._opacity||i.material.opacity,i.material.color.copy(i.material._color),i.material.opacity=i.material._opacity,this.enabled&&this.axis&&(i.name===this.axis||this.axis.split("").some(function(m){return i.name===m}))&&(i.material.color.setHex(16776960),i.material.opacity=1)}super.updateMatrixWorld(t)}}class Pe extends a{constructor(){super(new Ut(1e5,1e5,2,2),new dt({visible:!1,wireframe:!0,side:Wt,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(t){let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),at.copy(B).applyQuaternion(e==="local"?this.worldQuaternion:rt),G.copy(X).applyQuaternion(e==="local"?this.worldQuaternion:rt),K.copy(V).applyQuaternion(e==="local"?this.worldQuaternion:rt),p.copy(G),this.mode){case"translate":case"scale":switch(this.axis){case"X":p.copy(this.eye).cross(at),j.copy(at).cross(p);break;case"Y":p.copy(this.eye).cross(G),j.copy(G).cross(p);break;case"Z":p.copy(this.eye).cross(K),j.copy(K).cross(p);break;case"XY":j.copy(K);break;case"YZ":j.copy(at);break;case"XZ":p.copy(K),j.copy(G);break;case"XYZ":case"E":j.set(0,0,0);break}break;case"rotate":default:j.set(0,0,0)}j.length()===0?this.quaternion.copy(this.cameraQuaternion):(Tt.lookAt(b.set(0,0,0),j,p),this.quaternion.setFromRotationMatrix(Tt)),super.updateMatrixWorld(t)}}function Ee(){const n=document.querySelector("#canvas");if(!n){console.error("Canvas element not found.");return}const t=new Ft,e=new Gt({antialias:!0,canvas:n}),s=Q(),o=A();t.add(o);const h=new te(s,e.domElement);h.listenToKeyEvents(window),h.enableDamping=!0,h.maxDistance=100,h.minDistance=1;const i=new ue(s,e.domElement);i.addEventListener("dragging-changed",function(d){h.enabled=!d.value});const r=i.getHelper(),m=new Kt(5),S=new Bt(10,10,8947848,4473924),g=new $t,T=document.createElement("div");T.style.fontSize="12px",T.style.padding="12px 4px",T.style.color="#ebebeb",T.style.lineHeight="1.3",T.innerHTML=`
        <strong>Controls:</strong><br>
        Orbit: Left Mouse Button<br>
        Zoom: Right Mouse Button<br>
        Pan: Right Mouse Button
    `,g.domElement.querySelector(".children").appendChild(T);const y={transformMode:"translate",space:"world",gizmoVisible:!0,axesHelper:!1,gridHelper:!0,centerCube(){h.target.set(0,0,0)},resetCube(){o.position.set(0,0,0),o.rotation.set(0,0,0),o.scale.set(1,1,1)}};g.add(y,"transformMode",["translate","rotate","scale"]).name("Transform Mode").onChange(d=>{i.setMode(d)}),g.add(y,"space",["world","local"]).name("Space").onChange(d=>{i.setSpace(d)}),g.add(y,"gizmoVisible").name("Show Gizmo").onChange(Z),g.add(y,"axesHelper").name("Show Axes").onChange(Z),g.add(y,"gridHelper").name("Show Grid").onChange(Z),g.add(y,"centerCube").name("Reset Pan"),g.add(y,"resetCube").name("Reset Cube Transform");function Z(){y.axesHelper?t.add(m):t.remove(m),y.gridHelper?t.add(S):t.remove(S),y.gizmoVisible?(t.add(r),i.attach(o)):i.detach()}Z(),window.addEventListener("resize",x,!1),x(),e.setAnimationLoop(I);function Q(){const d=new Vt(75,n.clientWidth/n.clientHeight,.1,1e3);return d.position.x=2,d.position.y=2,d.position.z=2,d}function A(){const d=new w(1,1,1),f=new dt({color:15511039});return new a(d,f)}function I(d){h.update(),e.render(t,s)}function x(){const d=Math.min(window.devicePixelRatio,2),f=Math.round(n.clientWidth*d),L=Math.round(n.clientHeight*d);e.setSize(f,L,!1),n.width=f,n.height=L,s.aspect=n.clientWidth/n.clientHeight,s.updateProjectionMatrix()}}Ee();
