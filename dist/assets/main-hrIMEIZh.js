import{V as _,S as Y,W as Z,L as J,P as Q,a as z,R as ee,B as te,A as ne,b as oe,c as ie,C as ae}from"./three.module-Ovx678Xv.js";import{S as re}from"./stats.module--VATS4Kh.js";import{G as se}from"./GLTFLoader-DRcDx2hr.js";import{E as le}from"./EXRLoader-BrqGqE0a.js";import{E as ce,R as de,O as ue,S as B,F as me,G as he}from"./GammaCorrectionShader-CXhsNxzJ.js";import{O as fe}from"./OrbitControls-BeonOkOq.js";let m,i,s={x:0,y:.22,z:1.2},f,V,A,d,W,o=null,a={x:-1e5,y:-1e5},X,P={x:-1e5,y:-1e5},O,b,j,R,u,g,U,r,x,F,y,T,S,L,E=.1,H=.03,k=new _,v=new _;const h=window.location.pathname.split("/"),n=document.querySelector("#canvas"),M=["home","01_setup","02_line","03_responsive","04_orbit","05_nesting","06_lil-gui","07_load_gltf","08_load_bunny","09_materials","10_textures","11_textures_gltf","12_animations","13_lighting","14_background","15_userinteraction"];function ge(){if(!n){console.error("Canvas element not found.");return}b=new ie,b.onProgress=function(c,p,w){const C=p/w*100;console.log(`Progress: ${C.toFixed(2)}% (${p} of ${w})`)},b.onLoad=function(){m.environment=W,m.add(d)},m=new Y,m.background=null,f=new Z({antialias:!0,alpha:!0,premultipliedAlpha:!1,canvas:n}),f.outputColorSpace=J,i=new Q(55,n.clientWidth/n.clientHeight,.1,100),i.position.set(s.x,s.y,s.z),i.lookAt(s.x,s.y,0),g=new ce(f),U=new de(m,i),g.addPass(U),r=new ue(new z(n.clientWidth,n.clientHeight),m,i),r.edgeStrength=3,r.edgeGlow=0,r.edgeThickness=3,r.pulsePeriod=0,r.visibleEdgeColor.set("#ffffff"),r.hiddenEdgeColor.set("#ffffff"),g.addPass(r),x=new B(me);const e=Math.min(window.devicePixelRatio,4);x.material.uniforms.resolution.value.x=1/(n.clientWidth*e),x.material.uniforms.resolution.value.y=1/(n.clientHeight*e),g.addPass(x),F=new B(he),g.addPass(F),u=new fe(i,f.domElement),u.listenToKeyEvents(window),u.enableDamping=!0,u.enablePan=!1,u.enableZoom=!0,u.enableRotate=!1,u.target.set(s.x,s.y,0),u.update(),O=new ee,new z,A=new re,document.body.appendChild(A.dom),new se(b).load("../../models/control_panel/v06_control_panel.glb",c=>{d=c.scene;const p=new te().setFromObject(d).getSize(new _);if(d.position.y-=p.y*.5,d.position.x-=p.x*.5,console.log(p),y=d.children[1].children[2].children[1].material.clone(),T=y.clone(),y.name="light_green_lit",T.emissive.set("#1CBB22"),S=d.children[1].children[3].children[1].material.clone(),L=S.clone(),S.name="light_red_lit",L.emissive.set("#CC1C1C"),h[h.length-1]=="index.html"){const w=Number((h[h.length-2].match(/\d+/)||[0])[0]);w>0&&w<16&&(d.children.find(C=>C.name=="button_"+(w+1).toString().padStart(2,"0")).children[3].children[1].material=L)}else d.children[2].children[3].children[1].material=L},void 0,c=>{console.error("Error loading model:",c)});const l=new ne(16777215,2);m.add(l),j=new le(b),R=new oe(f),j.load("../../hdri/hdri_peppermint_powerplant_2k.exr",c=>{W=R.fromEquirectangular(c).texture,c.dispose(),R.dispose()}),V=new ae,f.setAnimationLoop(pe),window.addEventListener("resize",D,!1),D(),window.addEventListener("mousemove",K),window.addEventListener("mouseout",G),window.addEventListener("mouseleave",G),window.addEventListener("click",q),window.addEventListener("touchstart",xe),window.addEventListener("touchend",be)}function pe(){V.getDelta(),A.update(),ye(),Pe(),g.render(m,i)}function D(){const e=Math.min(window.devicePixelRatio,4),t=Math.round(n.clientWidth*e),l=Math.round(n.clientHeight*e);f.setSize(t,l,!1),n.width=t,n.height=l,u.update(),_e(),g.setSize(t,l),x.material.uniforms.resolution.value.x=1/(t*e),x.material.uniforms.resolution.value.y=1/(l*e),i.aspect=n.clientWidth/n.clientHeight,i.updateProjectionMatrix()}function we(e){const t=e.match(/button_(\d+)/);return t&&t[1]?parseInt(t[1],10):null}function $(e){const t=we(e);return t==null?null:h[h.length-1]=="index.html"?h[h.length-2]==M[t-1]?null:"../"+M[t-1]+"/index.html":t==1?null:"dist/src/"+M[t-1]+"/index.html"}function q(){if(o&&o.name.includes("button")){console.log("Clicked:",o.parent.name);const e=$(o.parent.name);e&&setTimeout(()=>{window.location.href=e},500)}}function xe(e){K(e.touches[0]),X=Date.now(),P.x=a.x,P.y=a.y}function be(){Date.now()-X<200&&Math.abs(P.x-a.x)<.01&&Math.abs(P.y-a.y)<.01&&q(),G()}function Le(e){const t=n.getBoundingClientRect();return{x:(e.clientX-t.left)*n.width/t.width,y:(e.clientY-t.top)*n.height/t.height}}function K(e){const t=Le(e);a.x=t.x/n.width*2-1,a.y=t.y/n.height*-2+1}function G(){a.x=-1e5,a.y=-1e5}function ve(){o.name.includes("_")?r.selectedObjects=[o]:r.selectedObjects=[o.parent.children[1]],document.body.style.cursor="pointer",$(o.parent.name)&&(o.parent.children[2].children[1].material=T)}function N(){r.selectedObjects=[],document.body.style.cursor="default"}function I(e){e==null||!e.name.includes("button")||(e.parent.children[2].children[1].material=y)}function ye(){O.setFromCamera(a,i);const e=O.intersectObjects(m.children,!0);e.length>0?o!==e[0].object&&(I(o),o=e[0].object,o.name.includes("button")?ve():N()):o!==null&&(N(),I(o),o=null)}function Pe(){a.x==-1e5||a.y==-1e5?(k.set(s.x,s.y,0),E=.02):(k.set(s.x+H*a.x,s.y+H*a.y,0),E=.1),i.getWorldDirection(v),v.add(i.position),v.lerp(k,E),i.lookAt(v)}function _e(){const e=new _(1.4,.7,.5),t=n.clientWidth/n.clientHeight,l=i.fov*(Math.PI/180),c=Math.max(e.x/(2*Math.tan(l/2)*t),e.y/(2*Math.tan(l/2)),e.z);i.position.z=.25+c*1.1}ge();
