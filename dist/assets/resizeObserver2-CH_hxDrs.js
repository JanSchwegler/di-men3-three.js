import{S as F,W as j,L as G,P as W,a as C,R as _,B as D,V,A as $,e as q,d as I,C as X}from"./three.module-C2ykHa-j.js";import{S as Y}from"./stats.module--VATS4Kh.js";import{G as J}from"./GLTFLoader-wxPdE2H_.js";import{E as K,R as N,O as Q,S as L,F as U,G as Z}from"./GammaCorrectionShader-BuJRrrEB.js";let l,u,f,T,y,c,b,E,B=0,m=null,d={x:-1e5,y:-1e5},R,p={x:-1e5,y:-1e5},P,S,h,z,r,w,M;const i=document.querySelector("#canvas"),x=document.querySelector("#htmlContent");function ee(){if(!i){console.error("Canvas element not found.");return}S=new I,S.onProgress=function(n,a,t){const s=a/t*100;console.log(`Progress: ${s.toFixed(2)}% (${a} of ${t})`)},l=new F,l.background=null,f=new j({antialias:!0,alpha:!0,premultipliedAlpha:!1,canvas:i}),f.outputColorSpace=G,u=new W(55,i.clientWidth/i.clientHeight,.1,100),u.position.set(0,0,2),h=new K(f),z=new N(l,u),h.addPass(z),r=new Q(new C(i.clientWidth,i.clientHeight),l,u),r.edgeStrength=1,r.edgeGlow=2,r.edgeThickness=5,r.pulsePeriod=0,r.visibleEdgeColor.set("#000000"),r.hiddenEdgeColor.set("#000000"),r.selectedObjects=l.children,h.addPass(r),w=new L(U);const e=Math.min(window.devicePixelRatio,4);w.material.uniforms.resolution.value.x=1/(i.clientWidth*e),w.material.uniforms.resolution.value.y=1/(i.clientHeight*e),h.addPass(w),M=new L(Z),h.addPass(M),P=new _,new C,y=new Y,document.body.appendChild(y.dom),new J(S).load("../../models/bunny/12_animations.glb",n=>{c=n.scene,c.position.y-=new D().setFromObject(c).getSize(new V).y*.5,l.add(c);const a=n.animations.find(t=>t.name.toLowerCase()==="idle");a&&te(a)},void 0,n=>{console.error("Error loading bunny:",n)});const H=new $(16777215,2);l.add(H),T=new X,f.setAnimationLoop(ne),window.addEventListener("scroll",oe),window.addEventListener("mousemove",A),window.addEventListener("mouseout",v),window.addEventListener("mouseleave",v),window.addEventListener("click",k),window.addEventListener("touchstart",ie),window.addEventListener("touchend",ae);const O=((n,a)=>{let t;return(...s)=>{t&&clearTimeout(t),t=setTimeout(()=>{n(...s),t=null},a)}})(n=>{const a=Math.min(window.devicePixelRatio,4);let t,s;n.devicePixelContentBoxSize?(t=n.devicePixelContentBoxSize[0].inlineSize,s=n.devicePixelContentBoxSize[0].blockSize):(t=Math.round(n.contentBoxSize[0].inlineSize*a),s=Math.round(n.contentBoxSize[0].blockSize*a)),u.aspect=t/s,u.updateProjectionMatrix(),f.setSize(t,s,!1),n.target.width=t,n.target.height=s,h.setSize(t,s),w.material.uniforms.resolution.value.set(1/t,1/s)},100);new ResizeObserver(n=>{for(const a of n)O(a)}).observe(i)}function ne(){const e=T.getDelta();y.update(),b&&b.update(e),c&&(c.rotation.y=B*Math.PI*-2),re(),h.render(l,u)}function te(e){b=new q(c),E=b.clipAction(e),E.play()}function oe(){const e=window.pageYOffset,o=document.documentElement.scrollHeight-window.innerHeight;B=e/o}function ie(e){A(e.touches[0]),R=Date.now(),p.x=d.x,p.y=d.y}function ae(){Date.now()-R<200&&Math.abs(p.x-d.x)<.01&&Math.abs(p.y-d.y)<.01&&k(),v()}function k(){if(m)switch(m.name){case"bunny002_1":g("Bunny Body");break;case"bunny002_2":g("Bunny Head");break;case"bunny002_3":g("Bunny Eye");break;default:g("HTML Content");break}else g("HTML Content")}function g(e){if(x)for(let o=x.children.length-1;o>=0;o--)x.children[o].innerHTML=e}function se(e){const o=i.getBoundingClientRect();return{x:(e.clientX-o.left)*i.width/o.width,y:(e.clientY-o.top)*i.height/o.height}}function A(e){const o=se(e);d.x=o.x/i.width*2-1,d.y=o.y/i.height*-2+1}function v(){d.x=-1e5,d.y=-1e5}function re(){if(P.setFromCamera(d,u),c){const e=P.intersectObjects(c.children[0].children[0].children,!0);e.length>0?m!==e[0].object&&(m=e[0].object,document.body.style.cursor="pointer"):m!==null&&(m=null,document.body.style.cursor="default")}}ee();
